import{p as Pe,u as Se}from"./index-b2d8d4c2.js";import"./Index-25fb47ed.js";const{SvelteComponent:Ce,append:v,attr:T,detach:ee,element:z,flush:B,init:Te,insert:te,noop:X,safe_not_equal:ze,set_data:I,set_style:G,space:H,text:W,toggle_class:Y}=window.__gradio__svelte__internal,{onMount:De,createEventDispatcher:We,getContext:je}=window.__gradio__svelte__internal;function Z(t){let e,n,l,s,o=q(t[2])+"",f,d,r,a,h=t[2].orig_name+"",g;return{c(){e=z("div"),n=z("span"),l=z("div"),s=z("progress"),f=W(o),r=H(),a=z("span"),g=W(h),G(s,"visibility","hidden"),G(s,"height","0"),G(s,"width","0"),s.value=d=q(t[2]),T(s,"max","100"),T(s,"class","svelte-1vsfomn"),T(l,"class","progress-bar svelte-1vsfomn"),T(a,"class","file-name svelte-1vsfomn"),T(e,"class","file svelte-1vsfomn")},m(c,_){te(c,e,_),v(e,n),v(n,l),v(l,s),v(s,f),v(e,r),v(e,a),v(a,g)},p(c,_){_&4&&o!==(o=q(c[2])+"")&&I(f,o),_&4&&d!==(d=q(c[2]))&&(s.value=d),_&4&&h!==(h=c[2].orig_name+"")&&I(g,h)},d(c){c&&ee(e)}}}function qe(t){let e,n,l,s=t[0].length+"",o,f,d=t[0].length>1?"files":"file",r,a,h,g=t[2]&&Z(t);return{c(){e=z("div"),n=z("span"),l=W("Uploading "),o=W(s),f=H(),r=W(d),a=W("..."),h=H(),g&&g.c(),T(n,"class","uploading svelte-1vsfomn"),T(e,"class","wrap svelte-1vsfomn"),Y(e,"progress",t[1])},m(c,_){te(c,e,_),v(e,n),v(n,l),v(n,o),v(n,f),v(n,r),v(n,a),v(e,h),g&&g.m(e,null)},p(c,[_]){_&1&&s!==(s=c[0].length+"")&&I(o,s),_&1&&d!==(d=c[0].length>1?"files":"file")&&I(r,d),c[2]?g?g.p(c,_):(g=Z(c),g.c(),g.m(e,null)):g&&(g.d(1),g=null),_&2&&Y(e,"progress",c[1])},i:X,o:X,d(c){c&&ee(e),g&&g.d()}}}function q(t){return t.progress*100/(t.size||0)||0}function Me(t){let e=0;return t.forEach(n=>{e+=q(n)}),document.documentElement.style.setProperty("--upload-progress-width",(e/t.length).toFixed(2)+"%"),e/t.length}function Ne(t,e,n){let{upload_id:l}=e,{root:s}=e,{files:o}=e,f,d=!1,r,a,h=o.map(u=>({...u,progress:0}));const g=We();function c(u,p){n(0,h=h.map(A=>(A.orig_name===u&&(A.progress+=p),A)))}const _=je("EventSource_factory");return De(()=>{f=_(new URL(`${s}/upload_progress?upload_id=${l}`)),f.onmessage=async function(u){const p=JSON.parse(u.data);d||n(1,d=!0),p.msg==="done"?(f.close(),g("done")):(n(6,r=p),c(p.orig_name,p.chunk_size))}}),t.$$set=u=>{"upload_id"in u&&n(3,l=u.upload_id),"root"in u&&n(4,s=u.root),"files"in u&&n(5,o=u.files)},t.$$.update=()=>{t.$$.dirty&1&&Me(h),t.$$.dirty&65&&n(2,a=r||h[0])},[h,d,a,l,s,o,r]}class Ie extends Ce{constructor(e){super(),Te(this,e,Ne,qe,ze,{upload_id:3,root:4,files:5})}get upload_id(){return this.$$.ctx[3]}set upload_id(e){this.$$set({upload_id:e}),B()}get root(){return this.$$.ctx[4]}set root(e){this.$$set({root:e}),B()}get files(){return this.$$.ctx[5]}set files(e){this.$$set({files:e}),B()}}const{SvelteComponent:Je,append:x,attr:y,binding_callbacks:Le,bubble:P,check_outros:le,create_component:Oe,create_slot:ne,destroy_component:Re,detach:J,element:K,empty:ie,flush:k,get_all_dirty_from_scope:se,get_slot_changes:re,group_outros:oe,init:Be,insert:L,listen:w,mount_component:Ge,prevent_default:S,run_all:He,safe_not_equal:Ke,set_style:ae,space:Qe,stop_propagation:C,toggle_class:m,transition_in:F,transition_out:D,update_slot_base:ue}=window.__gradio__svelte__internal,{createEventDispatcher:Ve,tick:Xe,getContext:Ye}=window.__gradio__svelte__internal;function Ze(t){let e,n,l,s,o,f,d,r,a,h,g;const c=t[23].default,_=ne(c,t,t[22],null);return{c(){e=K("button"),_&&_.c(),n=Qe(),l=K("input"),y(l,"aria-label","file upload"),y(l,"data-testid","file-upload"),y(l,"type","file"),y(l,"accept",s=t[15]||void 0),l.multiple=o=t[6]==="multiple"||void 0,y(l,"webkitdirectory",f=t[6]==="directory"||void 0),y(l,"mozdirectory",d=t[6]==="directory"||void 0),y(l,"class","svelte-j5bxrl"),y(e,"tabindex",r=t[9]?-1:0),y(e,"class","svelte-j5bxrl"),m(e,"hidden",t[9]),m(e,"center",t[4]),m(e,"boundedheight",t[3]),m(e,"flex",t[5]),m(e,"disable_click",t[7]),ae(e,"height","100%")},m(u,p){L(u,e,p),_&&_.m(e,null),x(e,n),x(e,l),t[31](l),a=!0,h||(g=[w(l,"change",t[17]),w(e,"drag",C(S(t[24]))),w(e,"dragstart",C(S(t[25]))),w(e,"dragend",C(S(t[26]))),w(e,"dragover",C(S(t[27]))),w(e,"dragenter",C(S(t[28]))),w(e,"dragleave",C(S(t[29]))),w(e,"drop",C(S(t[30]))),w(e,"click",t[12]),w(e,"drop",t[18]),w(e,"dragenter",t[16]),w(e,"dragleave",t[16])],h=!0)},p(u,p){_&&_.p&&(!a||p[0]&4194304)&&ue(_,c,u,u[22],a?re(c,u[22],p,null):se(u[22]),null),(!a||p[0]&32768&&s!==(s=u[15]||void 0))&&y(l,"accept",s),(!a||p[0]&64&&o!==(o=u[6]==="multiple"||void 0))&&(l.multiple=o),(!a||p[0]&64&&f!==(f=u[6]==="directory"||void 0))&&y(l,"webkitdirectory",f),(!a||p[0]&64&&d!==(d=u[6]==="directory"||void 0))&&y(l,"mozdirectory",d),(!a||p[0]&512&&r!==(r=u[9]?-1:0))&&y(e,"tabindex",r),(!a||p[0]&512)&&m(e,"hidden",u[9]),(!a||p[0]&16)&&m(e,"center",u[4]),(!a||p[0]&8)&&m(e,"boundedheight",u[3]),(!a||p[0]&32)&&m(e,"flex",u[5]),(!a||p[0]&128)&&m(e,"disable_click",u[7])},i(u){a||(F(_,u),a=!0)},o(u){D(_,u),a=!1},d(u){u&&J(e),_&&_.d(u),t[31](null),h=!1,He(g)}}}function xe(t){let e,n,l=!t[9]&&$(t);return{c(){l&&l.c(),e=ie()},m(s,o){l&&l.m(s,o),L(s,e,o),n=!0},p(s,o){s[9]?l&&(oe(),D(l,1,1,()=>{l=null}),le()):l?(l.p(s,o),o[0]&512&&F(l,1)):(l=$(s),l.c(),F(l,1),l.m(e.parentNode,e))},i(s){n||(F(l),n=!0)},o(s){D(l),n=!1},d(s){s&&J(e),l&&l.d(s)}}}function $e(t){let e,n,l,s,o;const f=t[23].default,d=ne(f,t,t[22],null);return{c(){e=K("button"),d&&d.c(),y(e,"tabindex",n=t[9]?-1:0),y(e,"class","svelte-j5bxrl"),m(e,"hidden",t[9]),m(e,"center",t[4]),m(e,"boundedheight",t[3]),m(e,"flex",t[5]),ae(e,"height","100%")},m(r,a){L(r,e,a),d&&d.m(e,null),l=!0,s||(o=w(e,"click",t[11]),s=!0)},p(r,a){d&&d.p&&(!l||a[0]&4194304)&&ue(d,f,r,r[22],l?re(f,r[22],a,null):se(r[22]),null),(!l||a[0]&512&&n!==(n=r[9]?-1:0))&&y(e,"tabindex",n),(!l||a[0]&512)&&m(e,"hidden",r[9]),(!l||a[0]&16)&&m(e,"center",r[4]),(!l||a[0]&8)&&m(e,"boundedheight",r[3]),(!l||a[0]&32)&&m(e,"flex",r[5])},i(r){l||(F(d,r),l=!0)},o(r){D(d,r),l=!1},d(r){r&&J(e),d&&d.d(r),s=!1,o()}}}function $(t){let e,n;return e=new Ie({props:{root:t[8],upload_id:t[13],files:t[14]}}),{c(){Oe(e.$$.fragment)},m(l,s){Ge(e,l,s),n=!0},p(l,s){const o={};s[0]&256&&(o.root=l[8]),s[0]&8192&&(o.upload_id=l[13]),s[0]&16384&&(o.files=l[14]),e.$set(o)},i(l){n||(F(e.$$.fragment,l),n=!0)},o(l){D(e.$$.fragment,l),n=!1},d(l){Re(e,l)}}}function et(t){let e,n,l,s;const o=[$e,xe,Ze],f=[];function d(r,a){return r[0]==="clipboard"?0:r[1]&&r[10]?1:2}return e=d(t),n=f[e]=o[e](t),{c(){n.c(),l=ie()},m(r,a){f[e].m(r,a),L(r,l,a),s=!0},p(r,a){let h=e;e=d(r),e===h?f[e].p(r,a):(oe(),D(f[h],1,1,()=>{f[h]=null}),le(),n=f[e],n?n.p(r,a):(n=f[e]=o[e](r),n.c()),F(n,1),n.m(l.parentNode,l))},i(r){s||(F(n),s=!0)},o(r){D(n),s=!1},d(r){r&&J(l),f[e].d(r)}}}function tt(t,e,n){if(!t||t==="*"||t==="file/*"||Array.isArray(t)&&t.some(s=>s==="*"||s==="file/*"))return!0;let l;if(typeof t=="string")l=t.split(",").map(s=>s.trim());else if(Array.isArray(t))l=t;else return!1;return l.includes(e)||l.some(s=>{const[o]=s.split("/").map(f=>f.trim());return s.endsWith("/*")&&n.startsWith(o+"/")})}function lt(t,e,n){let{$$slots:l={},$$scope:s}=e,{filetype:o=null}=e,{dragging:f=!1}=e,{boundedheight:d=!0}=e,{center:r=!0}=e,{flex:a=!0}=e,{file_count:h="single"}=e,{disable_click:g=!1}=e,{root:c}=e,{hidden:_=!1}=e,{format:u="file"}=e,{uploading:p=!1}=e,{hidden_upload:A=null}=e,{show_progress:Q=!0}=e,O,R,j;const fe=Ye("upload_files"),M=Ve(),de=["image","video","audio","text","file"],V=i=>i.startsWith(".")||i.endsWith("/*")?i:de.includes(i)?i+"/*":"."+i;function _e(){n(19,f=!f)}function ce(){navigator.clipboard.read().then(async i=>{for(let b=0;b<i.length;b++){const U=i[b].types.find(E=>E.startsWith("image/"));if(U){i[b].getType(U).then(async E=>{const Fe=new File([E],`clipboard.${U.replace("image/","")}`);await N([Fe])});break}}})}function ge(){g||A&&(n(2,A.value="",A),A.click())}async function he(i){await Xe(),n(13,O=Math.random().toString(36).substring(2,15)),n(1,p=!0);const b=await Se(i,c,O,fe);return M("load",h==="single"?b?.[0]:b),n(1,p=!1),b||[]}async function N(i){if(!i.length)return;let b=i.map(U=>new File([U],U.name,{type:U.type}));return n(14,R=await Pe(b)),await he(R)}async function pe(i){const b=i.target;if(b.files)if(u!="blob")await N(Array.from(b.files));else{if(h==="single"){M("load",b.files[0]);return}M("load",b.files)}}async function me(i){if(n(19,f=!1),!i.dataTransfer?.files)return;const b=Array.from(i.dataTransfer.files).filter(U=>{const E="."+U.name.split(".").pop();return E&&tt(j,E,U.type)||(E&&Array.isArray(o)?o.includes(E):E===o)?!0:(M("error",`Invalid file type only ${o} allowed.`),!1)});await N(b)}function be(i){P.call(this,t,i)}function ye(i){P.call(this,t,i)}function ve(i){P.call(this,t,i)}function ke(i){P.call(this,t,i)}function we(i){P.call(this,t,i)}function Ae(i){P.call(this,t,i)}function Ue(i){P.call(this,t,i)}function Ee(i){Le[i?"unshift":"push"](()=>{A=i,n(2,A)})}return t.$$set=i=>{"filetype"in i&&n(0,o=i.filetype),"dragging"in i&&n(19,f=i.dragging),"boundedheight"in i&&n(3,d=i.boundedheight),"center"in i&&n(4,r=i.center),"flex"in i&&n(5,a=i.flex),"file_count"in i&&n(6,h=i.file_count),"disable_click"in i&&n(7,g=i.disable_click),"root"in i&&n(8,c=i.root),"hidden"in i&&n(9,_=i.hidden),"format"in i&&n(20,u=i.format),"uploading"in i&&n(1,p=i.uploading),"hidden_upload"in i&&n(2,A=i.hidden_upload),"show_progress"in i&&n(10,Q=i.show_progress),"$$scope"in i&&n(22,s=i.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&1&&(o==null?n(15,j=null):typeof o=="string"?n(15,j=V(o)):(n(0,o=o.map(V)),n(15,j=o.join(", "))))},[o,p,A,d,r,a,h,g,c,_,Q,ce,ge,O,R,j,_e,pe,me,f,u,N,s,l,be,ye,ve,ke,we,Ae,Ue,Ee]}class st extends Je{constructor(e){super(),Be(this,e,lt,et,Ke,{filetype:0,dragging:19,boundedheight:3,center:4,flex:5,file_count:6,disable_click:7,root:8,hidden:9,format:20,uploading:1,hidden_upload:2,show_progress:10,paste_clipboard:11,open_file_upload:12,load_files:21},null,[-1,-1])}get filetype(){return this.$$.ctx[0]}set filetype(e){this.$$set({filetype:e}),k()}get dragging(){return this.$$.ctx[19]}set dragging(e){this.$$set({dragging:e}),k()}get boundedheight(){return this.$$.ctx[3]}set boundedheight(e){this.$$set({boundedheight:e}),k()}get center(){return this.$$.ctx[4]}set center(e){this.$$set({center:e}),k()}get flex(){return this.$$.ctx[5]}set flex(e){this.$$set({flex:e}),k()}get file_count(){return this.$$.ctx[6]}set file_count(e){this.$$set({file_count:e}),k()}get disable_click(){return this.$$.ctx[7]}set disable_click(e){this.$$set({disable_click:e}),k()}get root(){return this.$$.ctx[8]}set root(e){this.$$set({root:e}),k()}get hidden(){return this.$$.ctx[9]}set hidden(e){this.$$set({hidden:e}),k()}get format(){return this.$$.ctx[20]}set format(e){this.$$set({format:e}),k()}get uploading(){return this.$$.ctx[1]}set uploading(e){this.$$set({uploading:e}),k()}get hidden_upload(){return this.$$.ctx[2]}set hidden_upload(e){this.$$set({hidden_upload:e}),k()}get show_progress(){return this.$$.ctx[10]}set show_progress(e){this.$$set({show_progress:e}),k()}get paste_clipboard(){return this.$$.ctx[11]}get open_file_upload(){return this.$$.ctx[12]}get load_files(){return this.$$.ctx[21]}}export{st as U};
//# sourceMappingURL=ModifyUpload.svelte_svelte_type_style_lang-0f01576e.js.map
