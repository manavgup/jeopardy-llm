import{f as bt}from"./SelectSource.svelte_svelte_type_style_lang-a1c177eb.js";import{u as wt}from"./utils-572af92b.js";import{B as _t}from"./BlockLabel-773ad87b.js";import{I as ft}from"./IconButton-246c08f4.js";import{E as vt}from"./Empty-72ec7a6b.js";import{S as $t}from"./ShareButton-9408f3c5.js";import{D as kt,a as yt}from"./DownloadLink-f0c308cc.js";import"./Index-25fb47ed.js";import{I as Fe}from"./Image-eaba773f.js";import{I as dt}from"./Image-ea4957e8.js";import{p as It,u as St}from"./index-b2d8d4c2.js";import{W as qt,S as Ct}from"./SelectSource-e2808105.js";import{D as mt}from"./DropdownArrow-67e4280e.js";import{U as Dt}from"./ModifyUpload.svelte_svelte_type_style_lang-0f01576e.js";import{C as Et}from"./Clear-2c7bae91.js";const{SvelteComponent:Wt,append:Ve,attr:N,detach:Mt,init:Bt,insert:Nt,noop:Ce,safe_not_equal:Tt,svg_element:De}=window.__gradio__svelte__internal;function Rt(i){let e,n,t;return{c(){e=De("svg"),n=De("path"),t=De("circle"),N(n,"d","M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"),N(t,"cx","12"),N(t,"cy","13"),N(t,"r","4"),N(e,"xmlns","http://www.w3.org/2000/svg"),N(e,"width","100%"),N(e,"height","100%"),N(e,"viewBox","0 0 24 24"),N(e,"fill","none"),N(e,"stroke","currentColor"),N(e,"stroke-width","1.5"),N(e,"stroke-linecap","round"),N(e,"stroke-linejoin","round"),N(e,"class","feather feather-camera")},m(l,r){Nt(l,e,r),Ve(e,n),Ve(e,t)},p:Ce,i:Ce,o:Ce,d(l){l&&Mt(e)}}}class Ht extends Wt{constructor(e){super(),Bt(this,e,null,Rt,Tt,{})}}const{SvelteComponent:Ut,append:Pt,attr:z,detach:jt,init:Lt,insert:zt,noop:Ee,safe_not_equal:At,svg_element:Ge}=window.__gradio__svelte__internal;function Ft(i){let e,n;return{c(){e=Ge("svg"),n=Ge("circle"),z(n,"cx","12"),z(n,"cy","12"),z(n,"r","10"),z(e,"xmlns","http://www.w3.org/2000/svg"),z(e,"width","100%"),z(e,"height","100%"),z(e,"viewBox","0 0 24 24"),z(e,"stroke-width","1.5"),z(e,"stroke-linecap","round"),z(e,"stroke-linejoin","round"),z(e,"class","feather feather-circle")},m(t,l){zt(t,e,l),Pt(e,n)},p:Ee,i:Ee,o:Ee,d(t){t&&jt(e)}}}class Ot extends Ut{constructor(e){super(),Lt(this,e,null,Ft,At,{})}}const{SvelteComponent:Xt,append:Yt,attr:T,detach:Vt,init:Gt,insert:Jt,noop:We,safe_not_equal:Kt,svg_element:Je}=window.__gradio__svelte__internal;function Qt(i){let e,n;return{c(){e=Je("svg"),n=Je("rect"),T(n,"x","3"),T(n,"y","3"),T(n,"width","18"),T(n,"height","18"),T(n,"rx","2"),T(n,"ry","2"),T(e,"xmlns","http://www.w3.org/2000/svg"),T(e,"width","100%"),T(e,"height","100%"),T(e,"viewBox","0 0 24 24"),T(e,"stroke-width","1.5"),T(e,"stroke-linecap","round"),T(e,"stroke-linejoin","round"),T(e,"class","feather feather-square")},m(t,l){Jt(t,e,l),Yt(e,n)},p:We,i:We,o:We,d(t){t&&Vt(e)}}}class Zt extends Xt{constructor(e){super(),Gt(this,e,null,Qt,Kt,{})}}const gt=i=>{let e;if(i.currentTarget instanceof Element)e=i.currentTarget.querySelector("img");else return[NaN,NaN];const n=e.getBoundingClientRect(),t=e.naturalWidth/n.width,l=e.naturalHeight/n.height;if(t>l){const u=e.naturalHeight/t,c=(n.height-u)/2;var r=Math.round((i.clientX-n.left)*t),o=Math.round((i.clientY-n.top-c)*t)}else{const u=e.naturalWidth/l,c=(n.width-u)/2;var r=Math.round((i.clientX-n.left-c)*l),o=Math.round((i.clientY-n.top)*l)}return r<0||r>=e.naturalWidth||o<0||o>=e.naturalHeight?null:[r,o]};const{SvelteComponent:xt,append:Ke,attr:Me,bubble:Qe,check_outros:He,create_component:J,destroy_component:K,detach:oe,element:Be,empty:en,flush:V,group_outros:Ue,init:tn,insert:ae,listen:nn,mount_component:Q,safe_not_equal:ln,space:Pe,toggle_class:Ze,transition_in:B,transition_out:P}=window.__gradio__svelte__internal,{createEventDispatcher:rn}=window.__gradio__svelte__internal;function on(i){let e,n,t,l,r,o,u,c,g,a=i[3]&&xe(i),s=i[5]&&et(i);return o=new dt({props:{src:i[0].url,alt:"",loading:"lazy"}}),{c(){e=Be("div"),a&&a.c(),n=Pe(),s&&s.c(),t=Pe(),l=Be("button"),r=Be("div"),J(o.$$.fragment),Me(e,"class","icon-buttons svelte-1l6wqyv"),Me(r,"class","image-container svelte-1l6wqyv"),Ze(r,"selectable",i[4]),Me(l,"class","svelte-1l6wqyv")},m(m,p){ae(m,e,p),a&&a.m(e,null),Ke(e,n),s&&s.m(e,null),ae(m,t,p),ae(m,l,p),Ke(l,r),Q(o,r,null),u=!0,c||(g=nn(l,"click",i[7]),c=!0)},p(m,p){m[3]?a?(a.p(m,p),p&8&&B(a,1)):(a=xe(m),a.c(),B(a,1),a.m(e,n)):a&&(Ue(),P(a,1,1,()=>{a=null}),He()),m[5]?s?(s.p(m,p),p&32&&B(s,1)):(s=et(m),s.c(),B(s,1),s.m(e,null)):s&&(Ue(),P(s,1,1,()=>{s=null}),He());const y={};p&1&&(y.src=m[0].url),o.$set(y),(!u||p&16)&&Ze(r,"selectable",m[4])},i(m){u||(B(a),B(s),B(o.$$.fragment,m),u=!0)},o(m){P(a),P(s),P(o.$$.fragment,m),u=!1},d(m){m&&(oe(e),oe(t),oe(l)),a&&a.d(),s&&s.d(),K(o),c=!1,g()}}}function an(i){let e,n;return e=new vt({props:{unpadded_box:!0,size:"large",$$slots:{default:[cn]},$$scope:{ctx:i}}}),{c(){J(e.$$.fragment)},m(t,l){Q(e,t,l),n=!0},p(t,l){const r={};l&4096&&(r.$$scope={dirty:l,ctx:t}),e.$set(r)},i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){P(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function xe(i){let e,n;return e=new kt({props:{href:i[0].url,download:i[0].orig_name||"image",$$slots:{default:[sn]},$$scope:{ctx:i}}}),{c(){J(e.$$.fragment)},m(t,l){Q(e,t,l),n=!0},p(t,l){const r={};l&1&&(r.href=t[0].url),l&1&&(r.download=t[0].orig_name||"image"),l&4160&&(r.$$scope={dirty:l,ctx:t}),e.$set(r)},i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){P(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function sn(i){let e,n;return e=new ft({props:{Icon:yt,label:i[6]("common.download")}}),{c(){J(e.$$.fragment)},m(t,l){Q(e,t,l),n=!0},p(t,l){const r={};l&64&&(r.label=t[6]("common.download")),e.$set(r)},i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){P(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function et(i){let e,n;return e=new $t({props:{i18n:i[6],formatter:i[8],value:i[0]}}),e.$on("share",i[9]),e.$on("error",i[10]),{c(){J(e.$$.fragment)},m(t,l){Q(e,t,l),n=!0},p(t,l){const r={};l&64&&(r.i18n=t[6]),l&1&&(r.value=t[0]),e.$set(r)},i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){P(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function cn(i){let e,n;return e=new Fe({}),{c(){J(e.$$.fragment)},m(t,l){Q(e,t,l),n=!0},i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){P(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function un(i){let e,n,t,l,r,o;e=new _t({props:{show_label:i[2],Icon:Fe,label:i[1]||i[6]("image.image")}});const u=[an,on],c=[];function g(a,s){return a[0]===null||!a[0].url?0:1}return t=g(i),l=c[t]=u[t](i),{c(){J(e.$$.fragment),n=Pe(),l.c(),r=en()},m(a,s){Q(e,a,s),ae(a,n,s),c[t].m(a,s),ae(a,r,s),o=!0},p(a,[s]){const m={};s&4&&(m.show_label=a[2]),s&66&&(m.label=a[1]||a[6]("image.image")),e.$set(m);let p=t;t=g(a),t===p?c[t].p(a,s):(Ue(),P(c[p],1,1,()=>{c[p]=null}),He(),l=c[t],l?l.p(a,s):(l=c[t]=u[t](a),l.c()),B(l,1),l.m(r.parentNode,r))},i(a){o||(B(e.$$.fragment,a),B(l),o=!0)},o(a){P(e.$$.fragment,a),P(l),o=!1},d(a){a&&(oe(n),oe(r)),K(e,a),c[t].d(a)}}}function _n(i,e,n){let{value:t}=e,{label:l=void 0}=e,{show_label:r}=e,{show_download_button:o=!0}=e,{selectable:u=!1}=e,{show_share_button:c=!1}=e,{i18n:g}=e;const a=rn(),s=_=>{let v=gt(_);v&&a("select",{index:v,value:null})},m=async _=>_?`<img src="${await wt(_,"base64")}" />`:"";function p(_){Qe.call(this,i,_)}function y(_){Qe.call(this,i,_)}return i.$$set=_=>{"value"in _&&n(0,t=_.value),"label"in _&&n(1,l=_.label),"show_label"in _&&n(2,r=_.show_label),"show_download_button"in _&&n(3,o=_.show_download_button),"selectable"in _&&n(4,u=_.selectable),"show_share_button"in _&&n(5,c=_.show_share_button),"i18n"in _&&n(6,g=_.i18n)},[t,l,r,o,u,c,g,s,m,p,y]}class fn extends xt{constructor(e){super(),tn(this,e,_n,un,ln,{value:0,label:1,show_label:2,show_download_button:3,selectable:4,show_share_button:5,i18n:6})}get value(){return this.$$.ctx[0]}set value(e){this.$$set({value:e}),V()}get label(){return this.$$.ctx[1]}set label(e){this.$$set({label:e}),V()}get show_label(){return this.$$.ctx[2]}set show_label(e){this.$$set({show_label:e}),V()}get show_download_button(){return this.$$.ctx[3]}set show_download_button(e){this.$$set({show_download_button:e}),V()}get selectable(){return this.$$.ctx[4]}set selectable(e){this.$$set({selectable:e}),V()}get show_share_button(){return this.$$.ctx[5]}set show_share_button(e){this.$$set({show_share_button:e}),V()}get i18n(){return this.$$.ctx[6]}set i18n(e){this.$$set({i18n:e}),V()}}const ti=fn;const{SvelteComponent:dn,append:fe,attr:Ne,create_component:mn,destroy_component:gn,detach:hn,element:Te,init:pn,insert:bn,listen:wn,mount_component:vn,noop:$n,safe_not_equal:kn,set_style:yn,space:In,text:Sn,transition_in:qn,transition_out:Cn}=window.__gradio__svelte__internal,{createEventDispatcher:Dn}=window.__gradio__svelte__internal;function En(i){let e,n,t,l,r,o="Click to Access Webcam",u,c,g,a;return l=new qt({}),{c(){e=Te("button"),n=Te("div"),t=Te("span"),mn(l.$$.fragment),r=In(),u=Sn(o),Ne(t,"class","icon-wrap svelte-qbrfs"),Ne(n,"class","wrap svelte-qbrfs"),Ne(e,"class","svelte-qbrfs"),yn(e,"height","100%")},m(s,m){bn(s,e,m),fe(e,n),fe(n,t),vn(l,t,null),fe(n,r),fe(n,u),c=!0,g||(a=wn(e,"click",i[1]),g=!0)},p:$n,i(s){c||(qn(l.$$.fragment,s),c=!0)},o(s){Cn(l.$$.fragment,s),c=!1},d(s){s&&hn(e),gn(l),g=!1,a()}}}function Wn(i){const e=Dn();return[e,()=>e("click")]}class Mn extends dn{constructor(e){super(),pn(this,e,Wn,En,kn,{})}}function Bn(){return navigator.mediaDevices.enumerateDevices()}function Nn(i,e){e.srcObject=i,e.muted=!0,e.play()}async function tt(i,e,n){const t={width:{ideal:1920},height:{ideal:1440}},l={video:n?{deviceId:{exact:n},...t}:t,audio:i};return navigator.mediaDevices.getUserMedia(l).then(r=>(Nn(r,e),r))}function Tn(i){return i.filter(n=>n.kind==="videoinput")}const{SvelteComponent:Rn,action_destroyer:Hn,add_render_callback:Un,append:O,attr:I,binding_callbacks:Pn,check_outros:se,create_component:te,create_in_transition:jn,destroy_component:ne,destroy_each:Ln,detach:R,element:j,empty:Oe,ensure_array_like:nt,flush:G,group_outros:ce,init:zn,insert:H,listen:we,mount_component:le,noop:Xe,run_all:An,safe_not_equal:Fn,set_data:ht,set_input_value:je,space:ue,stop_propagation:On,text:pt,toggle_class:de,transition_in:q,transition_out:E}=window.__gradio__svelte__internal,{createEventDispatcher:Xn,onMount:Yn}=window.__gradio__svelte__internal;function lt(i,e,n){const t=i.slice();return t[30]=e[n],t}function Vn(i){let e,n,t,l,r,o,u,c,g,a,s;const m=[Kn,Jn],p=[];function y(b,w){return b[1]==="video"||b[0]?0:1}t=y(i),l=p[t]=m[t](i);let _=!i[8]&&it(i),v=i[10]&&i[7]&&rt(i);return{c(){e=j("div"),n=j("button"),l.c(),o=ue(),_&&_.c(),u=ue(),v&&v.c(),c=Oe(),I(n,"aria-label",r=i[1]==="image"?"capture photo":"start recording"),I(n,"class","svelte-1aa1mud"),I(e,"class","button-wrap svelte-1aa1mud")},m(b,w){H(b,e,w),O(e,n),p[t].m(n,null),O(e,o),_&&_.m(e,null),H(b,u,w),v&&v.m(b,w),H(b,c,w),g=!0,a||(s=we(n,"click",i[13]),a=!0)},p(b,w){let L=t;t=y(b),t===L?p[t].p(b,w):(ce(),E(p[L],1,1,()=>{p[L]=null}),se(),l=p[t],l?l.p(b,w):(l=p[t]=m[t](b),l.c()),q(l,1),l.m(n,null)),(!g||w[0]&2&&r!==(r=b[1]==="image"?"capture photo":"start recording"))&&I(n,"aria-label",r),b[8]?_&&(ce(),E(_,1,1,()=>{_=null}),se()):_?(_.p(b,w),w[0]&256&&q(_,1)):(_=it(b),_.c(),q(_,1),_.m(e,null)),b[10]&&b[7]?v?(v.p(b,w),w[0]&1152&&q(v,1)):(v=rt(b),v.c(),q(v,1),v.m(c.parentNode,c)):v&&(ce(),E(v,1,1,()=>{v=null}),se())},i(b){g||(q(l),q(_),q(v),g=!0)},o(b){E(l),E(_),E(v),g=!1},d(b){b&&(R(e),R(u),R(c)),p[t].d(),_&&_.d(),v&&v.d(b),a=!1,s()}}}function Gn(i){let e,n,t,l;return n=new Mn({}),n.$on("click",i[19]),{c(){e=j("div"),te(n.$$.fragment),I(e,"title","grant webcam access")},m(r,o){H(r,e,o),le(n,e,null),l=!0},p:Xe,i(r){l||(q(n.$$.fragment,r),r&&(t||Un(()=>{t=jn(e,bt,{delay:100,duration:200}),t.start()})),l=!0)},o(r){E(n.$$.fragment,r),l=!1},d(r){r&&R(e),ne(n)}}}function Jn(i){let e,n,t;return n=new Ht({}),{c(){e=j("div"),te(n.$$.fragment),I(e,"class","icon svelte-1aa1mud"),I(e,"title","capture photo")},m(l,r){H(l,e,r),le(n,e,null),t=!0},p:Xe,i(l){t||(q(n.$$.fragment,l),t=!0)},o(l){E(n.$$.fragment,l),t=!1},d(l){l&&R(e),ne(n)}}}function Kn(i){let e,n,t,l;const r=[Zn,Qn],o=[];function u(c,g){return c[8]?0:1}return e=u(i),n=o[e]=r[e](i),{c(){n.c(),t=Oe()},m(c,g){o[e].m(c,g),H(c,t,g),l=!0},p(c,g){let a=e;e=u(c),e!==a&&(ce(),E(o[a],1,1,()=>{o[a]=null}),se(),n=o[e],n||(n=o[e]=r[e](c),n.c()),q(n,1),n.m(t.parentNode,t))},i(c){l||(q(n),l=!0)},o(c){E(n),l=!1},d(c){c&&R(t),o[e].d(c)}}}function Qn(i){let e,n,t;return n=new Ot({}),{c(){e=j("div"),te(n.$$.fragment),I(e,"class","icon red svelte-1aa1mud"),I(e,"title","start recording")},m(l,r){H(l,e,r),le(n,e,null),t=!0},i(l){t||(q(n.$$.fragment,l),t=!0)},o(l){E(n.$$.fragment,l),t=!1},d(l){l&&R(e),ne(n)}}}function Zn(i){let e,n,t;return n=new Zt({}),{c(){e=j("div"),te(n.$$.fragment),I(e,"class","icon red svelte-1aa1mud"),I(e,"title","stop recording")},m(l,r){H(l,e,r),le(n,e,null),t=!0},i(l){t||(q(n.$$.fragment,l),t=!0)},o(l){E(n.$$.fragment,l),t=!1},d(l){l&&R(e),ne(n)}}}function it(i){let e,n,t,l,r;return n=new mt({}),{c(){e=j("button"),te(n.$$.fragment),I(e,"class","icon svelte-1aa1mud"),I(e,"aria-label","select input source")},m(o,u){H(o,e,u),le(n,e,null),t=!0,l||(r=we(e,"click",i[20]),l=!0)},p:Xe,i(o){t||(q(n.$$.fragment,o),t=!0)},o(o){E(n.$$.fragment,o),t=!1},d(o){o&&R(e),ne(n),l=!1,r()}}}function rt(i){let e,n,t,l,r,o,u;t=new mt({});function c(s,m){return s[6].length===0?el:xn}let g=c(i),a=g(i);return{c(){e=j("select"),n=j("button"),te(t.$$.fragment),l=ue(),a.c(),I(n,"class","inset-icon svelte-1aa1mud"),I(e,"class","select-wrap svelte-1aa1mud"),I(e,"aria-label","select source")},m(s,m){H(s,e,m),O(e,n),le(t,n,null),O(n,l),a.m(e,null),r=!0,o||(u=[we(n,"click",On(i[21])),Hn(Ye.call(null,e,i[14])),we(e,"change",i[11])],o=!0)},p(s,m){g===(g=c(s))&&a?a.p(s,m):(a.d(1),a=g(s),a&&(a.c(),a.m(e,null)))},i(s){r||(q(t.$$.fragment,s),r=!0)},o(s){E(t.$$.fragment,s),r=!1},d(s){s&&R(e),ne(t),a.d(),o=!1,An(u)}}}function xn(i){let e,n=nt(i[6]),t=[];for(let l=0;l<n.length;l+=1)t[l]=ot(lt(i,n,l));return{c(){for(let l=0;l<t.length;l+=1)t[l].c();e=Oe()},m(l,r){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(l,r);H(l,e,r)},p(l,r){if(r[0]&192){n=nt(l[6]);let o;for(o=0;o<n.length;o+=1){const u=lt(l,n,o);t[o]?t[o].p(u,r):(t[o]=ot(u),t[o].c(),t[o].m(e.parentNode,e))}for(;o<t.length;o+=1)t[o].d(1);t.length=n.length}},d(l){l&&R(e),Ln(t,l)}}}function el(i){let e,n=i[3]("common.no_devices")+"",t;return{c(){e=j("option"),t=pt(n),e.__value="",je(e,e.__value),I(e,"class","svelte-1aa1mud")},m(l,r){H(l,e,r),O(e,t)},p(l,r){r[0]&8&&n!==(n=l[3]("common.no_devices")+"")&&ht(t,n)},d(l){l&&R(e)}}}function ot(i){let e,n=i[30].label+"",t,l,r,o;return{c(){e=j("option"),t=pt(n),l=ue(),e.__value=r=i[30].deviceId,je(e,e.__value),e.selected=o=i[7].deviceId===i[30].deviceId,I(e,"class","svelte-1aa1mud")},m(u,c){H(u,e,c),O(e,t),O(e,l)},p(u,c){c[0]&64&&n!==(n=u[30].label+"")&&ht(t,n),c[0]&64&&r!==(r=u[30].deviceId)&&(e.__value=r,je(e,e.__value)),c[0]&192&&o!==(o=u[7].deviceId===u[30].deviceId)&&(e.selected=o)},d(u){u&&R(e)}}}function tl(i){let e,n,t,l,r,o;const u=[Gn,Vn],c=[];function g(a,s){return a[9]?1:0}return l=g(i),r=c[l]=u[l](i),{c(){e=j("div"),n=j("video"),t=ue(),r.c(),I(n,"class","svelte-1aa1mud"),de(n,"flip",i[2]),de(n,"hide",!i[9]),I(e,"class","wrap svelte-1aa1mud")},m(a,s){H(a,e,s),O(e,n),i[18](n),O(e,t),c[l].m(e,null),o=!0},p(a,s){(!o||s[0]&4)&&de(n,"flip",a[2]),(!o||s[0]&512)&&de(n,"hide",!a[9]);let m=l;l=g(a),l===m?c[l].p(a,s):(ce(),E(c[m],1,1,()=>{c[m]=null}),se(),r=c[l],r?r.p(a,s):(r=c[l]=u[l](a),r.c()),q(r,1),r.m(e,null))},i(a){o||(q(r),o=!0)},o(a){E(r),o=!1},d(a){a&&R(e),i[18](null),c[l].d()}}}function Ye(i,e){const n=t=>{i&&!i.contains(t.target)&&!t.defaultPrevented&&e(t)};return document.addEventListener("click",n,!0),{destroy(){document.removeEventListener("click",n,!0)}}}function nl(i,e,n){let t,l=[],r=null,o,{streaming:u=!1}=e,{pending:c=!1}=e,{root:g=""}=e,{mode:a="image"}=e,{mirror_webcam:s}=e,{include_audio:m}=e,{i18n:p}=e;const y=Xn();Yn(()=>o=document.createElement("canvas"));const _=async h=>{const F=h.target.value;await tt(m,t,F).then(async ie=>{C=ie,n(7,r=l.find(re=>re.deviceId===F)||null),n(10,D=!1)})};async function v(){try{tt(m,t).then(async h=>{n(9,k=!0),n(6,l=await Bn()),C=h}).then(()=>Tn(l)).then(h=>{n(6,l=h);const W=C.getTracks().map(F=>F.getSettings()?.deviceId)[0];n(7,r=W&&h.find(F=>F.deviceId===W)||l[0])}),(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)&&y("error",p("image.no_webcam_support"))}catch(h){if(h instanceof DOMException&&h.name=="NotAllowedError")y("error",p("image.allow_webcam_access"));else throw h}}function b(){var h=o.getContext("2d");(!u||u&&w)&&t.videoWidth&&t.videoHeight&&(o.width=t.videoWidth,o.height=t.videoHeight,h.drawImage(t,0,0,t.videoWidth,t.videoHeight),s&&(h.scale(-1,1),h.drawImage(t,-t.videoWidth,0)),o.toBlob(W=>{y(u?"stream":"capture",W)},"image/png",.8))}let w=!1,L=[],C,U,$;function d(){if(w){$.stop();let h=new Blob(L,{type:U}),W=new FileReader;W.onload=async function(F){if(F.target){let ie=new File([h],"sample."+U.substring(6));const re=await It([ie]);let f=(await St(re,g))?.filter(Boolean)[0];y("capture",f),y("stop_recording")}},W.readAsDataURL(h)}else{y("start_recording"),L=[];let h=["video/webm","video/mp4"];for(let W of h)if(MediaRecorder.isTypeSupported(W)){U=W;break}if(U===null){console.error("No supported MediaRecorder mimeType");return}$=new MediaRecorder(C,{mimeType:U}),$.addEventListener("dataavailable",function(W){L.push(W.data)}),$.start(200)}n(8,w=!w)}let k=!1;function X(){a==="image"&&u&&n(8,w=!w),a==="image"?b():d(),!w&&C&&(C.getTracks().forEach(h=>h.stop()),n(5,t.srcObject=null,t),n(9,k=!1))}u&&a==="image"&&window.setInterval(()=>{t&&!c&&b()},500);let D=!1;function Y(h){h.preventDefault(),h.stopPropagation(),n(10,D=!1)}function ye(h){Pn[h?"unshift":"push"](()=>{t=h,n(5,t)})}const Ie=async()=>v(),Se=()=>n(10,D=!0),qe=()=>n(10,D=!1);return i.$$set=h=>{"streaming"in h&&n(0,u=h.streaming),"pending"in h&&n(15,c=h.pending),"root"in h&&n(16,g=h.root),"mode"in h&&n(1,a=h.mode),"mirror_webcam"in h&&n(2,s=h.mirror_webcam),"include_audio"in h&&n(17,m=h.include_audio),"i18n"in h&&n(3,p=h.i18n)},[u,a,s,p,Ye,t,l,r,w,k,D,_,v,X,Y,c,g,m,ye,Ie,Se,qe]}class ll extends Rn{constructor(e){super(),zn(this,e,nl,tl,Fn,{streaming:0,pending:15,root:16,mode:1,mirror_webcam:2,include_audio:17,i18n:3,click_outside:4},null,[-1,-1])}get streaming(){return this.$$.ctx[0]}set streaming(e){this.$$set({streaming:e}),G()}get pending(){return this.$$.ctx[15]}set pending(e){this.$$set({pending:e}),G()}get root(){return this.$$.ctx[16]}set root(e){this.$$set({root:e}),G()}get mode(){return this.$$.ctx[1]}set mode(e){this.$$set({mode:e}),G()}get mirror_webcam(){return this.$$.ctx[2]}set mirror_webcam(e){this.$$set({mirror_webcam:e}),G()}get include_audio(){return this.$$.ctx[17]}set include_audio(e){this.$$set({include_audio:e}),G()}get i18n(){return this.$$.ctx[3]}set i18n(e){this.$$set({i18n:e}),G()}get click_outside(){return Ye}}const il=ll;const{SvelteComponent:rl,attr:ol,create_component:al,destroy_component:sl,detach:cl,element:ul,init:_l,insert:fl,mount_component:dl,noop:ml,safe_not_equal:gl,transition_in:hl,transition_out:pl}=window.__gradio__svelte__internal,{createEventDispatcher:bl}=window.__gradio__svelte__internal;function wl(i){let e,n,t;return n=new ft({props:{Icon:Et,label:"Remove Image"}}),n.$on("click",i[1]),{c(){e=ul("div"),al(n.$$.fragment),ol(e,"class","svelte-s6ybro")},m(l,r){fl(l,e,r),dl(n,e,null),t=!0},p:ml,i(l){t||(hl(n.$$.fragment,l),t=!0)},o(l){pl(n.$$.fragment,l),t=!1},d(l){l&&cl(e),sl(n)}}}function vl(i){const e=bl();return[e,t=>{e("remove_image"),t.stopPropagation()}]}class $l extends rl{constructor(e){super(),_l(this,e,vl,wl,gl,{})}}const{SvelteComponent:kl,add_flush_callback:Le,append:me,attr:he,bind:ze,binding_callbacks:ve,bubble:Re,check_outros:pe,create_component:Z,create_slot:yl,destroy_component:x,detach:$e,element:Ae,empty:Il,flush:A,get_all_dirty_from_scope:Sl,get_slot_changes:ql,group_outros:be,init:Cl,insert:ke,listen:Dl,mount_component:ee,noop:El,safe_not_equal:Wl,space:ge,toggle_class:at,transition_in:S,transition_out:M,update_slot_base:Ml}=window.__gradio__svelte__internal,{createEventDispatcher:Bl,tick:Nl}=window.__gradio__svelte__internal;function st(i){let e,n;return e=new $l({}),e.$on("remove_image",i[22]),{c(){Z(e.$$.fragment)},m(t,l){ee(e,t,l),n=!0},p:El,i(t){n||(S(e.$$.fragment,t),n=!0)},o(t){M(e.$$.fragment,t),n=!1},d(t){x(e,t)}}}function ct(i){let e;const n=i[21].default,t=yl(n,i,i[33],null);return{c(){t&&t.c()},m(l,r){t&&t.m(l,r),e=!0},p(l,r){t&&t.p&&(!e||r[1]&4)&&Ml(t,n,l,l[33],e?ql(n,l[33],r,null):Sl(l[33]),null)},i(l){e||(S(t,l),e=!0)},o(l){M(t,l),e=!1},d(l){t&&t.d(l)}}}function Tl(i){let e,n,t=i[1]===null&&ct(i);return{c(){t&&t.c(),e=Il()},m(l,r){t&&t.m(l,r),ke(l,e,r),n=!0},p(l,r){l[1]===null?t?(t.p(l,r),r[0]&2&&S(t,1)):(t=ct(l),t.c(),S(t,1),t.m(e.parentNode,e)):t&&(be(),M(t,1,1,()=>{t=null}),pe())},i(l){n||(S(t),n=!0)},o(l){M(t),n=!1},d(l){l&&$e(e),t&&t.d(l)}}}function Rl(i){let e,n,t,l,r;return n=new dt({props:{src:i[1].url,alt:i[1].alt_text}}),{c(){e=Ae("div"),Z(n.$$.fragment),he(e,"class","image-frame svelte-rrgd5g"),at(e,"selectable",i[7])},m(o,u){ke(o,e,u),ee(n,e,null),t=!0,l||(r=Dl(e,"click",i[18]),l=!0)},p(o,u){const c={};u[0]&2&&(c.src=o[1].url),u[0]&2&&(c.alt=o[1].alt_text),n.$set(c),(!t||u[0]&128)&&at(e,"selectable",o[7])},i(o){t||(S(n.$$.fragment,o),t=!0)},o(o){M(n.$$.fragment,o),t=!1},d(o){o&&$e(e),x(n),l=!1,r()}}}function Hl(i){let e,n;return e=new il({props:{root:i[8],mirror_webcam:i[6],streaming:i[5],mode:"image",include_audio:!1,i18n:i[9]}}),e.$on("capture",i[27]),e.$on("stream",i[28]),e.$on("error",i[29]),e.$on("drag",i[30]),e.$on("upload",i[31]),{c(){Z(e.$$.fragment)},m(t,l){ee(e,t,l),n=!0},p(t,l){const r={};l[0]&256&&(r.root=t[8]),l[0]&64&&(r.mirror_webcam=t[6]),l[0]&32&&(r.streaming=t[5]),l[0]&512&&(r.i18n=t[9]),e.$set(r)},i(t){n||(S(e.$$.fragment,t),n=!0)},o(t){M(e.$$.fragment,t),n=!1},d(t){x(e,t)}}}function ut(i){let e,n,t;function l(o){i[32](o)}let r={sources:i[4],handle_clear:i[15],handle_select:i[19]};return i[0]!==void 0&&(r.active_source=i[0]),e=new Ct({props:r}),ve.push(()=>ze(e,"active_source",l)),{c(){Z(e.$$.fragment)},m(o,u){ee(e,o,u),t=!0},p(o,u){const c={};u[0]&16&&(c.sources=o[4]),!n&&u[0]&1&&(n=!0,c.active_source=o[0],Le(()=>n=!1)),e.$set(c)},i(o){t||(S(e.$$.fragment,o),t=!0)},o(o){M(e.$$.fragment,o),t=!1},d(o){x(e,o)}}}function Ul(i){let e,n,t,l,r,o,u,c,g,a,s,m,p=i[4].length>1||i[4].includes("clipboard"),y;e=new _t({props:{show_label:i[3],Icon:Fe,label:i[2]||"Image"}});let _=i[1]?.url&&!i[12]&&st(i);function v(d){i[24](d)}function b(d){i[25](d)}let w={hidden:i[1]!==null||i[0]==="webcam",filetype:i[0]==="clipboard"?"clipboard":"image/*",root:i[8],disable_click:!i[4].includes("upload"),$$slots:{default:[Tl]},$$scope:{ctx:i}};i[10]!==void 0&&(w.uploading=i[10]),i[11]!==void 0&&(w.dragging=i[11]),o=new Dt({props:w}),i[23](o),ve.push(()=>ze(o,"uploading",v)),ve.push(()=>ze(o,"dragging",b)),o.$on("load",i[14]),o.$on("error",i[26]);const L=[Hl,Rl],C=[];function U(d,k){return d[0]==="webcam"&&(d[5]||!d[5]&&!d[1])?0:d[1]!==null&&!d[5]?1:-1}~(a=U(i))&&(s=C[a]=L[a](i));let $=p&&ut(i);return{c(){Z(e.$$.fragment),n=ge(),t=Ae("div"),_&&_.c(),l=ge(),r=Ae("div"),Z(o.$$.fragment),g=ge(),s&&s.c(),m=ge(),$&&$.c(),he(r,"class","upload-container svelte-rrgd5g"),he(t,"data-testid","image"),he(t,"class","image-container svelte-rrgd5g")},m(d,k){ee(e,d,k),ke(d,n,k),ke(d,t,k),_&&_.m(t,null),me(t,l),me(t,r),ee(o,r,null),me(r,g),~a&&C[a].m(r,null),me(t,m),$&&$.m(t,null),y=!0},p(d,k){const X={};k[0]&8&&(X.show_label=d[3]),k[0]&4&&(X.label=d[2]||"Image"),e.$set(X),d[1]?.url&&!d[12]?_?(_.p(d,k),k[0]&4098&&S(_,1)):(_=st(d),_.c(),S(_,1),_.m(t,l)):_&&(be(),M(_,1,1,()=>{_=null}),pe());const D={};k[0]&3&&(D.hidden=d[1]!==null||d[0]==="webcam"),k[0]&1&&(D.filetype=d[0]==="clipboard"?"clipboard":"image/*"),k[0]&256&&(D.root=d[8]),k[0]&16&&(D.disable_click=!d[4].includes("upload")),k[0]&2|k[1]&4&&(D.$$scope={dirty:k,ctx:d}),!u&&k[0]&1024&&(u=!0,D.uploading=d[10],Le(()=>u=!1)),!c&&k[0]&2048&&(c=!0,D.dragging=d[11],Le(()=>c=!1)),o.$set(D);let Y=a;a=U(d),a===Y?~a&&C[a].p(d,k):(s&&(be(),M(C[Y],1,1,()=>{C[Y]=null}),pe()),~a?(s=C[a],s?s.p(d,k):(s=C[a]=L[a](d),s.c()),S(s,1),s.m(r,null)):s=null),k[0]&16&&(p=d[4].length>1||d[4].includes("clipboard")),p?$?($.p(d,k),k[0]&16&&S($,1)):($=ut(d),$.c(),S($,1),$.m(t,null)):$&&(be(),M($,1,1,()=>{$=null}),pe())},i(d){y||(S(e.$$.fragment,d),S(_),S(o.$$.fragment,d),S(s),S($),y=!0)},o(d){M(e.$$.fragment,d),M(_),M(o.$$.fragment,d),M(s),M($),y=!1},d(d){d&&($e(n),$e(t)),x(e,d),_&&_.d(),i[23](null),x(o),~a&&C[a].d(),$&&$.d()}}}function Pl(i,e,n){let t,{$$slots:l={},$$scope:r}=e,{value:o}=e,{label:u=void 0}=e,{show_label:c}=e,{sources:g=["upload","clipboard","webcam"]}=e,{streaming:a=!1}=e,{pending:s=!1}=e,{mirror_webcam:m}=e,{selectable:p=!1}=e,{root:y}=e,{i18n:_}=e,v,b=!1,{active_source:w=null}=e;function L({detail:f}){n(1,o=f),$("upload")}function C(){n(1,o=null),$("clear"),$("change",null)}async function U(f){n(20,s=!0);const _e=await v.load_files([new File([f],"webcam.png")]);n(1,o=_e?.[0]||null),await Nl(),$(a?"stream":"change"),n(20,s=!1)}const $=Bl();let d=!1;function k(f){let _e=gt(f);_e&&$("select",{index:_e,value:null})}async function X(f){switch(f){case"clipboard":v.paste_clipboard();break}}const D=()=>{n(1,o=null),$("clear")};function Y(f){ve[f?"unshift":"push"](()=>{v=f,n(13,v)})}function ye(f){b=f,n(10,b)}function Ie(f){d=f,n(11,d)}function Se(f){Re.call(this,i,f)}const qe=f=>U(f.detail),h=f=>U(f.detail);function W(f){Re.call(this,i,f)}function F(f){Re.call(this,i,f)}const ie=f=>U(f.detail);function re(f){w=f,n(0,w),n(4,g)}return i.$$set=f=>{"value"in f&&n(1,o=f.value),"label"in f&&n(2,u=f.label),"show_label"in f&&n(3,c=f.show_label),"sources"in f&&n(4,g=f.sources),"streaming"in f&&n(5,a=f.streaming),"pending"in f&&n(20,s=f.pending),"mirror_webcam"in f&&n(6,m=f.mirror_webcam),"selectable"in f&&n(7,p=f.selectable),"root"in f&&n(8,y=f.root),"i18n"in f&&n(9,_=f.i18n),"active_source"in f&&n(0,w=f.active_source),"$$scope"in f&&n(33,r=f.$$scope)},i.$$.update=()=>{i.$$.dirty[0]&17&&!w&&g&&n(0,w=g[0]),i.$$.dirty[0]&33&&n(12,t=a&&w==="webcam"),i.$$.dirty[0]&5120&&b&&!t&&n(1,o=null),i.$$.dirty[0]&2048&&$("drag",d)},[w,o,u,c,g,a,m,p,y,_,b,d,t,v,L,C,U,$,k,X,s,l,D,Y,ye,Ie,Se,qe,h,W,F,ie,re,r]}class jl extends kl{constructor(e){super(),Cl(this,e,Pl,Ul,Wl,{value:1,label:2,show_label:3,sources:4,streaming:5,pending:20,mirror_webcam:6,selectable:7,root:8,i18n:9,active_source:0},null,[-1,-1])}get value(){return this.$$.ctx[1]}set value(e){this.$$set({value:e}),A()}get label(){return this.$$.ctx[2]}set label(e){this.$$set({label:e}),A()}get show_label(){return this.$$.ctx[3]}set show_label(e){this.$$set({show_label:e}),A()}get sources(){return this.$$.ctx[4]}set sources(e){this.$$set({sources:e}),A()}get streaming(){return this.$$.ctx[5]}set streaming(e){this.$$set({streaming:e}),A()}get pending(){return this.$$.ctx[20]}set pending(e){this.$$set({pending:e}),A()}get mirror_webcam(){return this.$$.ctx[6]}set mirror_webcam(e){this.$$set({mirror_webcam:e}),A()}get selectable(){return this.$$.ctx[7]}set selectable(e){this.$$set({selectable:e}),A()}get root(){return this.$$.ctx[8]}set root(e){this.$$set({root:e}),A()}get i18n(){return this.$$.ctx[9]}set i18n(e){this.$$set({i18n:e}),A()}get active_source(){return this.$$.ctx[0]}set active_source(e){this.$$set({active_source:e}),A()}}const ni=jl;export{ni as I,ti as S,il as W};
//# sourceMappingURL=ImageUploader-236da975.js.map
